<?xml version="1.0"?>
<openerp>
    <data noupdate="1">
        <record model="custom.search" id="custom_search_dashboard_som_canvis_a_indexada">
            <field name="name">[DASHBOARDS][SOM - Contractes] Número de canvis a indexada</field>
            <field name="query">
                SELECT
                    CAST(create_date AS DATE) as dates, count(*) as canvis
                FROM
                    giscedata_polissa_modcontractual
                WHERE
                    observacions LIKE '%Modcon canvi a indexada%'
                GROUP BY
                    CAST(create_date AS DATE)
            </field>
        </record>
    </data>
    <data>
        <record model="ir.actions.act_window" id="action_dashboard_som_canvis_a_indexada">
            <field name="name">Dashboards contractes SOM</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">dashboard</field>
            <field name="view_mode">dashboard,form</field>
            <field name="res_model">board.board</field>
        </record>
        <menuitem id="menu_dashboard_som_canvis_a_indexada" parent="board.dashboard_menu" action="action_dashboard_som_canvis_a_indexada"/>
        <record model="board.board" id="dashboard_som_contracts_dashboards">
            <field name="name" eval="'Dashboards Contractes SOM'"/>
            <field name="menu_id" eval="ref('menu_dashboard_som_canvis_a_indexada')"/>
        </record>
        <record model="ir.ui.view" id="views_dashboard_som_canvis_a_indexada">
            <field name="name">views_dashboard_som_canvis_a_indexada</field>
            <field name="model">custom.search.results</field>
            <field name="type">graph</field>
            <field name="priority" eval="16000"/>
            <field name="version" eval="2"/>
            <field name="arch" type="xml">
                <graph type="line">
                  <field name="dates" axis="x"/>
                  <field name="canvis" operator="+" axis="y"/>
                </graph>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_dashboard_som_canvis_a_indexada">
            <field name="name">Número de canvis a indexada</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">graph,tree,form</field><field name="limit" eval="0"/>
            <field name="res_model">custom.search.results</field>
            <field name="context" eval="{b'search_id': ref('custom_search_dashboard_som_canvis_a_indexada')}"/>
            <field name="domain">[]</field>
        </record>
        <record model="ir.actions.act_window.view" id="action_view_dashboard_dashboard_som_canvis_a_indexada">
            <field name="sequence" eval="1"/>
            <field name="view_mode">graph</field>
            <field name="view_id" ref="views_dashboard_som_canvis_a_indexada"/>
            <field name="act_window_id" ref="action_dashboard_som_canvis_a_indexada"/>
        </record>
        <record model="board.board.line" id="dashboard_dashboard_som_canvis_a_indexada">
            <field name="board_id" ref="dashboard_som_contracts_dashboards"/>
            <field name="sequence" eval="10"/>
            <field name="name">Altes i baixes de contractes els últims 60 dies</field>
            <field name="action_id" ref="action_dashboard_som_canvis_a_indexada"/>
        </record>
    </data>
</openerp>